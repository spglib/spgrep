from __future__ import annotations

import numpy as np
from spglib import get_pointgroup

from spgrep.utils import NDArrayInt, ndarray2d_to_integer_tuple

# List of point groups after applying transformation matrices given by `spglib.get_pointgroup`
# See https://github.com/spglib/spglib/issues/164
# Operations are ordered as same as Table 3.2.3.2 of ITA (2016).
pg_dataset = {
    "1": [[((1, 0, 0), (0, 1, 0), (0, 0, 1))]],
    "-1": [
        [
            ((1, 0, 0), (0, 1, 0), (0, 0, 1)),
            ((-1, 0, 0), (0, -1, 0), (0, 0, -1)),
        ]
    ],
    "2": [
        # unique axis-b
        [
            ((1, 0, 0), (0, 1, 0), (0, 0, 1)),
            ((-1, 0, 0), (0, 1, 0), (0, 0, -1)),
        ]
    ],
    "m": [
        # unique axis-b
        [
            ((1, 0, 0), (0, 1, 0), (0, 0, 1)),
            ((1, 0, 0), (0, -1, 0), (0, 0, 1)),
        ]
    ],
    "2/m": [
        # unique axis-b
        [
            ((1, 0, 0), (0, 1, 0), (0, 0, 1)),
            ((-1, 0, 0), (0, 1, 0), (0, 0, -1)),
            ((-1, 0, 0), (0, -1, 0), (0, 0, -1)),
            ((1, 0, 0), (0, -1, 0), (0, 0, 1)),
        ]
    ],
    "222": [
        [
            ((1, 0, 0), (0, 1, 0), (0, 0, 1)),
            ((-1, 0, 0), (0, -1, 0), (0, 0, 1)),
            ((-1, 0, 0), (0, 1, 0), (0, 0, -1)),
            ((1, 0, 0), (0, -1, 0), (0, 0, -1)),
        ]
    ],
    "mm2": [
        # unique axis-c
        [
            ((1, 0, 0), (0, 1, 0), (0, 0, 1)),
            ((-1, 0, 0), (0, -1, 0), (0, 0, 1)),
            ((1, 0, 0), (0, -1, 0), (0, 0, 1)),
            ((-1, 0, 0), (0, 1, 0), (0, 0, 1)),
        ],
        # unique axis-a
        [
            ((1, 0, 0), (0, 1, 0), (0, 0, 1)),
            ((1, 0, 0), (0, -1, 0), (0, 0, -1)),
            ((1, 0, 0), (0, 1, 0), (0, 0, -1)),
            ((1, 0, 0), (0, -1, 0), (0, 0, 1)),
        ],
        # unique axis-b
        [
            ((1, 0, 0), (0, 1, 0), (0, 0, 1)),
            ((-1, 0, 0), (0, 1, 0), (0, 0, -1)),
            ((1, 0, 0), (0, 1, 0), (0, 0, -1)),
            ((-1, 0, 0), (0, 1, 0), (0, 0, 1)),
        ],
    ],
    "mmm": [
        [
            ((1, 0, 0), (0, 1, 0), (0, 0, 1)),
            ((-1, 0, 0), (0, -1, 0), (0, 0, 1)),
            ((-1, 0, 0), (0, 1, 0), (0, 0, -1)),
            ((1, 0, 0), (0, -1, 0), (0, 0, -1)),
            ((-1, 0, 0), (0, -1, 0), (0, 0, -1)),
            ((1, 0, 0), (0, 1, 0), (0, 0, -1)),
            ((1, 0, 0), (0, -1, 0), (0, 0, 1)),
            ((-1, 0, 0), (0, 1, 0), (0, 0, 1)),
        ]
    ],
    "4": [
        [
            ((1, 0, 0), (0, 1, 0), (0, 0, 1)),
            ((-1, 0, 0), (0, -1, 0), (0, 0, 1)),
            ((0, -1, 0), (1, 0, 0), (0, 0, 1)),
            ((0, 1, 0), (-1, 0, 0), (0, 0, 1)),
        ]
    ],
    "-4": [
        [
            ((1, 0, 0), (0, 1, 0), (0, 0, 1)),
            ((-1, 0, 0), (0, -1, 0), (0, 0, 1)),
            ((0, 1, 0), (-1, 0, 0), (0, 0, -1)),
            ((0, -1, 0), (1, 0, 0), (0, 0, -1)),
        ]
    ],
    "4/m": [
        [
            ((1, 0, 0), (0, 1, 0), (0, 0, 1)),
            ((-1, 0, 0), (0, -1, 0), (0, 0, -1)),
            ((0, -1, 0), (1, 0, 0), (0, 0, 1)),
            ((0, 1, 0), (-1, 0, 0), (0, 0, 1)),
            ((-1, 0, 0), (0, -1, 0), (0, 0, 1)),
            ((1, 0, 0), (0, 1, 0), (0, 0, -1)),
            ((0, 1, 0), (-1, 0, 0), (0, 0, -1)),
            ((0, -1, 0), (1, 0, 0), (0, 0, -1)),
        ]
    ],
    "422": [
        [
            ((1, 0, 0), (0, 1, 0), (0, 0, 1)),
            ((-1, 0, 0), (0, -1, 0), (0, 0, 1)),
            ((0, -1, 0), (1, 0, 0), (0, 0, 1)),
            ((0, 1, 0), (-1, 0, 0), (0, 0, 1)),
            ((-1, 0, 0), (0, 1, 0), (0, 0, -1)),
            ((1, 0, 0), (0, -1, 0), (0, 0, -1)),
            ((0, 1, 0), (1, 0, 0), (0, 0, -1)),
            ((0, -1, 0), (-1, 0, 0), (0, 0, -1)),
        ]
    ],
    "4mm": [
        [
            ((1, 0, 0), (0, 1, 0), (0, 0, 1)),
            ((-1, 0, 0), (0, -1, 0), (0, 0, 1)),
            ((0, -1, 0), (1, 0, 0), (0, 0, 1)),
            ((0, 1, 0), (-1, 0, 0), (0, 0, 1)),
            ((1, 0, 0), (0, -1, 0), (0, 0, 1)),
            ((-1, 0, 0), (0, 1, 0), (0, 0, 1)),
            ((0, -1, 0), (-1, 0, 0), (0, 0, 1)),
            ((0, 1, 0), (1, 0, 0), (0, 0, 1)),
        ]
    ],
    "-42m": [
        # -42m
        [
            ((1, 0, 0), (0, 1, 0), (0, 0, 1)),
            ((-1, 0, 0), (0, -1, 0), (0, 0, 1)),
            ((0, 1, 0), (-1, 0, 0), (0, 0, -1)),
            ((0, -1, 0), (1, 0, 0), (0, 0, -1)),
            ((-1, 0, 0), (0, 1, 0), (0, 0, -1)),
            ((1, 0, 0), (0, -1, 0), (0, 0, -1)),
            ((0, -1, 0), (-1, 0, 0), (0, 0, 1)),
            ((0, 1, 0), (1, 0, 0), (0, 0, 1)),
        ],
        # -4m2
        [
            ((1, 0, 0), (0, 1, 0), (0, 0, 1)),
            ((-1, 0, 0), (0, -1, 0), (0, 0, 1)),
            ((0, 1, 0), (-1, 0, 0), (0, 0, -1)),
            ((0, -1, 0), (1, 0, 0), (0, 0, -1)),
            ((1, 0, 0), (0, -1, 0), (0, 0, 1)),
            ((-1, 0, 0), (0, 1, 0), (0, 0, 1)),
            ((0, 1, 0), (1, 0, 0), (0, 0, -1)),
            ((0, -1, 0), (-1, 0, 0), (0, 0, -1)),
        ],
    ],
    "4/mmm": [
        [
            ((1, 0, 0), (0, 1, 0), (0, 0, 1)),
            ((-1, 0, 0), (0, -1, 0), (0, 0, 1)),
            ((0, -1, 0), (1, 0, 0), (0, 0, 1)),
            ((0, 1, 0), (-1, 0, 0), (0, 0, 1)),
            ((-1, 0, 0), (0, 1, 0), (0, 0, -1)),
            ((1, 0, 0), (0, -1, 0), (0, 0, -1)),
            ((0, 1, 0), (1, 0, 0), (0, 0, -1)),
            ((0, -1, 0), (-1, 0, 0), (0, 0, -1)),
            ((-1, 0, 0), (0, -1, 0), (0, 0, -1)),
            ((1, 0, 0), (0, 1, 0), (0, 0, -1)),
            ((0, 1, 0), (-1, 0, 0), (0, 0, -1)),
            ((0, -1, 0), (1, 0, 0), (0, 0, -1)),
            ((1, 0, 0), (0, -1, 0), (0, 0, 1)),
            ((-1, 0, 0), (0, 1, 0), (0, 0, 1)),
            ((0, -1, 0), (-1, 0, 0), (0, 0, 1)),
            ((0, 1, 0), (1, 0, 0), (0, 0, 1)),
        ]
    ],
    "3": [
        # Hexagonal axes
        [
            ((1, 0, 0), (0, 1, 0), (0, 0, 1)),
            ((0, -1, 0), (1, -1, 0), (0, 0, 1)),
            ((-1, 1, 0), (-1, 0, 0), (0, 0, 1)),
        ]
    ],
    "-3": [
        # Hexagonal axes
        [
            ((1, 0, 0), (0, 1, 0), (0, 0, 1)),
            ((0, -1, 0), (1, -1, 0), (0, 0, 1)),
            ((-1, 1, 0), (-1, 0, 0), (0, 0, 1)),
            ((-1, 0, 0), (0, -1, 0), (0, 0, -1)),
            ((0, 1, 0), (-1, 1, 0), (0, 0, -1)),
            ((1, -1, 0), (1, 0, 0), (0, 0, -1)),
        ]
    ],
    "32": [
        # 312
        [
            ((1, 0, 0), (0, 1, 0), (0, 0, 1)),
            ((0, -1, 0), (1, -1, 0), (0, 0, 1)),
            ((-1, 1, 0), (-1, 0, 0), (0, 0, 1)),
            ((0, -1, 0), (-1, 0, 0), (0, 0, -1)),
            ((-1, 1, 0), (0, 1, 0), (0, 0, -1)),
            ((1, 0, 0), (1, -1, 0), (0, 0, -1)),
        ],
        # 321
        [
            ((1, 0, 0), (0, 1, 0), (0, 0, 1)),
            ((0, -1, 0), (1, -1, 0), (0, 0, 1)),
            ((-1, 1, 0), (-1, 0, 0), (0, 0, 1)),
            ((0, 1, 0), (1, 0, 0), (0, 0, -1)),
            ((1, -1, 0), (0, -1, 0), (0, 0, -1)),
            ((-1, 0, 0), (-1, 1, 0), (0, 0, -1)),
        ],
    ],
    "3m": [
        # 3m1
        [
            ((1, 0, 0), (0, 1, 0), (0, 0, 1)),
            ((0, -1, 0), (1, -1, 0), (0, 0, 1)),
            ((-1, 1, 0), (-1, 0, 0), (0, 0, 1)),
            ((0, -1, 0), (-1, 0, 0), (0, 0, 1)),
            ((-1, 1, 0), (0, 1, 0), (0, 0, 1)),
            ((1, 0, 0), (1, -1, 0), (0, 0, 1)),
        ],
        # 31m
        [
            ((1, 0, 0), (0, 1, 0), (0, 0, 1)),
            ((0, -1, 0), (1, -1, 0), (0, 0, 1)),
            ((-1, 1, 0), (-1, 0, 0), (0, 0, 1)),
            ((0, 1, 0), (1, 0, 0), (0, 0, 1)),
            ((1, -1, 0), (0, -1, 0), (0, 0, 1)),
            ((-1, 0, 0), (-1, 1, 0), (0, 0, 1)),
        ],
    ],
    "-3m": [
        # -31m
        [
            ((1, 0, 0), (0, 1, 0), (0, 0, 1)),
            ((0, -1, 0), (1, -1, 0), (0, 0, 1)),
            ((-1, 1, 0), (-1, 0, 0), (0, 0, 1)),
            ((0, -1, 0), (-1, 0, 0), (0, 0, -1)),
            ((-1, 1, 0), (0, 1, 0), (0, 0, -1)),
            ((1, 0, 0), (1, -1, 0), (0, 0, -1)),
            ((-1, 0, 0), (0, -1, 0), (0, 0, -1)),
            ((0, 1, 0), (-1, 1, 0), (0, 0, -1)),
            ((1, -1, 0), (1, 0, 0), (0, 0, -1)),
            ((0, 1, 0), (1, 0, 0), (0, 0, 1)),
            ((1, -1, 0), (0, -1, 0), (0, 0, 1)),
            ((-1, 0, 0), (-1, 1, 0), (0, 0, 1)),
        ],
        # -3m1
        [
            ((1, 0, 0), (0, 1, 0), (0, 0, 1)),
            ((0, -1, 0), (1, -1, 0), (0, 0, 1)),
            ((-1, 1, 0), (-1, 0, 0), (0, 0, 1)),
            ((0, 1, 0), (1, 0, 0), (0, 0, -1)),
            ((1, -1, 0), (0, -1, 0), (0, 0, -1)),
            ((-1, 0, 0), (-1, 1, 0), (0, 0, -1)),
            ((-1, 0, 0), (0, -1, 0), (0, 0, -1)),
            ((0, 1, 0), (-1, 1, 0), (0, 0, -1)),
            ((1, -1, 0), (1, 0, 0), (0, 0, -1)),
            ((0, -1, 0), (-1, 0, 0), (0, 0, 1)),
            ((-1, 1, 0), (0, 1, 0), (0, 0, 1)),
            ((1, 0, 0), (1, -1, 0), (0, 0, 1)),
        ],
    ],
    "6": [
        [
            ((1, 0, 0), (0, 1, 0), (0, 0, 1)),
            ((0, -1, 0), (1, -1, 0), (0, 0, 1)),
            ((-1, 1, 0), (-1, 0, 0), (0, 0, 1)),
            ((-1, 0, 0), (0, -1, 0), (0, 0, 1)),
            ((0, 1, 0), (-1, 1, 0), (0, 0, 1)),
            ((1, -1, 0), (1, 0, 0), (0, 0, 1)),
        ]
    ],
    "-6": [
        [
            ((1, 0, 0), (0, 1, 0), (0, 0, 1)),
            ((0, -1, 0), (1, -1, 0), (0, 0, 1)),
            ((-1, 1, 0), (-1, 0, 0), (0, 0, 1)),
            ((1, 0, 0), (0, 1, 0), (0, 0, -1)),
            ((0, -1, 0), (1, -1, 0), (0, 0, -1)),
            ((-1, 1, 0), (-1, 0, 0), (0, 0, -1)),
        ]
    ],
    "6/m": [
        [
            ((1, 0, 0), (0, 1, 0), (0, 0, 1)),
            ((0, -1, 0), (1, -1, 0), (0, 0, 1)),
            ((-1, 1, 0), (-1, 0, 0), (0, 0, 1)),
            ((-1, 0, 0), (0, -1, 0), (0, 0, 1)),
            ((0, 1, 0), (-1, 1, 0), (0, 0, 1)),
            ((1, -1, 0), (1, 0, 0), (0, 0, 1)),
            ((-1, 0, 0), (0, -1, 0), (0, 0, -1)),
            ((0, 1, 0), (-1, 1, 0), (0, 0, -1)),
            ((1, -1, 0), (1, 0, 0), (0, 0, -1)),
            ((1, 0, 0), (0, 1, 0), (0, 0, -1)),
            ((0, -1, 0), (1, -1, 0), (0, 0, -1)),
            ((-1, 1, 0), (-1, 0, 0), (0, 0, -1)),
        ]
    ],
    "622": [
        [
            ((1, 0, 0), (0, 1, 0), (0, 0, 1)),
            ((0, -1, 0), (1, -1, 0), (0, 0, 1)),
            ((-1, 1, 0), (-1, 0, 0), (0, 0, 1)),
            ((-1, 0, 0), (0, -1, 0), (0, 0, 1)),
            ((0, 1, 0), (-1, 1, 0), (0, 0, 1)),
            ((1, -1, 0), (1, 0, 0), (0, 0, 1)),
            ((0, 1, 0), (1, 0, 0), (0, 0, -1)),
            ((1, -1, 0), (0, -1, 0), (0, 0, -1)),
            ((-1, 0, 0), (-1, 1, 0), (0, 0, -1)),
            ((0, -1, 0), (-1, 0, 0), (0, 0, -1)),
            ((-1, 1, 0), (0, 1, 0), (0, 0, -1)),
            ((1, 0, 0), (1, -1, 0), (0, 0, -1)),
        ]
    ],
    "6mm": [
        [
            ((1, 0, 0), (0, 1, 0), (0, 0, 1)),
            ((0, -1, 0), (1, -1, 0), (0, 0, 1)),
            ((-1, 1, 0), (-1, 0, 0), (0, 0, 1)),
            ((-1, 0, 0), (0, -1, 0), (0, 0, 1)),
            ((0, 1, 0), (-1, 1, 0), (0, 0, 1)),
            ((1, -1, 0), (1, 0, 0), (0, 0, 1)),
            ((0, -1, 0), (-1, 0, 0), (0, 0, 1)),
            ((-1, 1, 0), (0, 1, 0), (0, 0, 1)),
            ((1, 0, 0), (1, -1, 0), (0, 0, 1)),
            ((0, 1, 0), (1, 0, 0), (0, 0, 1)),
            ((1, -1, 0), (0, -1, 0), (0, 0, 1)),
            ((-1, 0, 0), (-1, 1, 0), (0, 0, 1)),
        ]
    ],
    "-6m2": [
        # -6m2
        [
            ((1, 0, 0), (0, 1, 0), (0, 0, 1)),
            ((0, -1, 0), (1, -1, 0), (0, 0, 1)),
            ((-1, 1, 0), (-1, 0, 0), (0, 0, 1)),
            ((1, 0, 0), (0, 1, 0), (0, 0, -1)),
            ((0, -1, 0), (1, -1, 0), (0, 0, -1)),
            ((-1, 1, 0), (-1, 0, 0), (0, 0, -1)),
            ((0, -1, 0), (-1, 0, 0), (0, 0, 1)),
            ((-1, 1, 0), (0, 1, 0), (0, 0, 1)),
            ((1, 0, 0), (1, -1, 0), (0, 0, 1)),
            ((0, -1, 0), (-1, 0, 0), (0, 0, -1)),
            ((-1, 1, 0), (0, 1, 0), (0, 0, -1)),
            ((1, 0, 0), (1, -1, 0), (0, 0, -1)),
        ],
        # -62m
        [
            ((1, 0, 0), (0, 1, 0), (0, 0, 1)),
            ((0, -1, 0), (1, -1, 0), (0, 0, 1)),
            ((-1, 1, 0), (-1, 0, 0), (0, 0, 1)),
            ((1, 0, 0), (0, 1, 0), (0, 0, -1)),
            ((0, -1, 0), (1, -1, 0), (0, 0, -1)),
            ((-1, 1, 0), (-1, 0, 0), (0, 0, -1)),
            ((0, 1, 0), (1, 0, 0), (0, 0, -1)),
            ((1, -1, 0), (0, -1, 0), (0, 0, -1)),
            ((-1, 0, 0), (-1, 1, 0), (0, 0, -1)),
            ((0, 1, 0), (1, 0, 0), (0, 0, 1)),
            ((1, -1, 0), (0, -1, 0), (0, 0, 1)),
            ((-1, 0, 0), (-1, 1, 0), (0, 0, 1)),
        ],
    ],
    "6/mmm": [
        [
            ((1, 0, 0), (0, 1, 0), (0, 0, 1)),
            ((0, -1, 0), (1, -1, 0), (0, 0, 1)),
            ((-1, 1, 0), (-1, 0, 0), (0, 0, 1)),
            ((-1, 0, 0), (0, -1, 0), (0, 0, 1)),
            ((0, 1, 0), (-1, 1, 0), (0, 0, 1)),
            ((1, -1, 0), (1, 0, 0), (0, 0, 1)),
            ((0, 1, 0), (1, 0, 0), (0, 0, -1)),
            ((1, -1, 0), (0, -1, 0), (0, 0, -1)),
            ((-1, 0, 0), (-1, 1, 0), (0, 0, -1)),
            ((0, -1, 0), (-1, 0, 0), (0, 0, -1)),
            ((-1, 1, 0), (0, 1, 0), (0, 0, -1)),
            ((1, 0, 0), (1, -1, 0), (0, 0, -1)),
            ((-1, 0, 0), (0, -1, 0), (0, 0, -1)),
            ((0, 1, 0), (-1, 1, 0), (0, 0, -1)),
            ((1, -1, 0), (1, 0, 0), (0, 0, -1)),
            ((1, 0, 0), (0, 1, 0), (0, 0, -1)),
            ((0, -1, 0), (1, -1, 0), (0, 0, -1)),
            ((-1, 1, 0), (-1, 0, 0), (0, 0, -1)),
            ((0, -1, 0), (-1, 0, 0), (0, 0, 1)),
            ((-1, 1, 0), (0, 1, 0), (0, 0, 1)),
            ((1, 0, 0), (1, -1, 0), (0, 0, 1)),
            ((0, 1, 0), (1, 0, 0), (0, 0, 1)),
            ((1, -1, 0), (0, -1, 0), (0, 0, 1)),
            ((-1, 0, 0), (-1, 1, 0), (0, 0, 1)),
        ]
    ],
    "23": [
        [
            ((1, 0, 0), (0, 1, 0), (0, 0, 1)),
            ((-1, 0, 0), (0, -1, 0), (0, 0, 1)),
            ((-1, 0, 0), (0, 1, 0), (0, 0, -1)),
            ((1, 0, 0), (0, -1, 0), (0, 0, -1)),
            ((0, 0, 1), (1, 0, 0), (0, 1, 0)),
            ((0, 0, 1), (-1, 0, 0), (0, -1, 0)),
            ((0, 0, -1), (-1, 0, 0), (0, 1, 0)),
            ((0, 0, -1), (1, 0, 0), (0, -1, 0)),
            ((0, 1, 0), (0, 0, 1), (1, 0, 0)),
            ((0, -1, 0), (0, 0, 1), (-1, 0, 0)),
            ((0, 1, 0), (0, 0, -1), (-1, 0, 0)),
            ((0, -1, 0), (0, 0, -1), (1, 0, 0)),
        ]
    ],
    "m-3": [
        [
            ((1, 0, 0), (0, 1, 0), (0, 0, 1)),
            ((-1, 0, 0), (0, -1, 0), (0, 0, 1)),
            ((-1, 0, 0), (0, 1, 0), (0, 0, -1)),
            ((1, 0, 0), (0, -1, 0), (0, 0, -1)),
            ((0, 0, 1), (1, 0, 0), (0, 1, 0)),
            ((0, 0, 1), (-1, 0, 0), (0, -1, 0)),
            ((0, 0, -1), (-1, 0, 0), (0, 1, 0)),
            ((0, 0, -1), (1, 0, 0), (0, -1, 0)),
            ((0, 1, 0), (0, 0, 1), (1, 0, 0)),
            ((0, -1, 0), (0, 0, 1), (-1, 0, 0)),
            ((0, 1, 0), (0, 0, -1), (-1, 0, 0)),
            ((0, -1, 0), (0, 0, -1), (1, 0, 0)),
            ((-1, 0, 0), (0, -1, 0), (0, 0, -1)),
            ((1, 0, 0), (0, 1, 0), (0, 0, -1)),
            ((1, 0, 0), (0, -1, 0), (0, 0, 1)),
            ((-1, 0, 0), (0, 1, 0), (0, 0, 1)),
            ((0, 0, -1), (-1, 0, 0), (0, -1, 0)),
            ((0, 0, -1), (1, 0, 0), (0, 1, 0)),
            ((0, 0, 1), (1, 0, 0), (0, -1, 0)),
            ((0, 0, 1), (-1, 0, 0), (0, 1, 0)),
            ((0, -1, 0), (0, 0, -1), (-1, 0, 0)),
            ((0, 1, 0), (0, 0, -1), (1, 0, 0)),
            ((0, -1, 0), (0, 0, 1), (1, 0, 0)),
            ((0, 1, 0), (0, 0, 1), (-1, 0, 0)),
        ]
    ],
    "432": [
        [
            ((1, 0, 0), (0, 1, 0), (0, 0, 1)),
            ((-1, 0, 0), (0, -1, 0), (0, 0, 1)),
            ((-1, 0, 0), (0, 1, 0), (0, 0, -1)),
            ((1, 0, 0), (0, -1, 0), (0, 0, -1)),
            ((0, 0, 1), (1, 0, 0), (0, 1, 0)),
            ((0, 0, 1), (-1, 0, 0), (0, -1, 0)),
            ((0, 0, -1), (-1, 0, 0), (0, 1, 0)),
            ((0, 0, -1), (1, 0, 0), (0, -1, 0)),
            ((0, 1, 0), (0, 0, 1), (1, 0, 0)),
            ((0, -1, 0), (0, 0, 1), (-1, 0, 0)),
            ((0, 1, 0), (0, 0, -1), (-1, 0, 0)),
            ((0, -1, 0), (0, 0, -1), (1, 0, 0)),
            ((0, 1, 0), (1, 0, 0), (0, 0, -1)),
            ((0, -1, 0), (-1, 0, 0), (0, 0, -1)),
            ((0, 1, 0), (-1, 0, 0), (0, 0, 1)),
            ((0, -1, 0), (1, 0, 0), (0, 0, 1)),
            ((1, 0, 0), (0, 0, 1), (0, -1, 0)),
            ((-1, 0, 0), (0, 0, 1), (0, 1, 0)),
            ((-1, 0, 0), (0, 0, -1), (0, -1, 0)),
            ((1, 0, 0), (0, 0, -1), (0, 1, 0)),
            ((0, 0, 1), (0, 1, 0), (-1, 0, 0)),
            ((0, 0, 1), (0, -1, 0), (1, 0, 0)),
            ((0, 0, -1), (0, 1, 0), (1, 0, 0)),
            ((0, 0, -1), (0, -1, 0), (-1, 0, 0)),
        ]
    ],
    "-43m": [
        [
            ((1, 0, 0), (0, 1, 0), (0, 0, 1)),
            ((-1, 0, 0), (0, -1, 0), (0, 0, 1)),
            ((-1, 0, 0), (0, 1, 0), (0, 0, -1)),
            ((1, 0, 0), (0, -1, 0), (0, 0, -1)),
            ((0, 0, 1), (1, 0, 0), (0, 1, 0)),
            ((0, 0, 1), (-1, 0, 0), (0, -1, 0)),
            ((0, 0, -1), (-1, 0, 0), (0, 1, 0)),
            ((0, 0, -1), (1, 0, 0), (0, -1, 0)),
            ((0, 1, 0), (0, 0, 1), (1, 0, 0)),
            ((0, -1, 0), (0, 0, 1), (-1, 0, 0)),
            ((0, 1, 0), (0, 0, -1), (-1, 0, 0)),
            ((0, -1, 0), (0, 0, -1), (1, 0, 0)),
            ((0, 1, 0), (1, 0, 0), (0, 0, 1)),
            ((0, -1, 0), (-1, 0, 0), (0, 0, 1)),
            ((0, 1, 0), (-1, 0, 0), (0, 0, -1)),
            ((0, -1, 0), (1, 0, 0), (0, 0, -1)),
            ((1, 0, 0), (0, 0, 1), (0, 1, 0)),
            ((-1, 0, 0), (0, 0, 1), (0, -1, 0)),
            ((-1, 0, 0), (0, 0, -1), (0, 1, 0)),
            ((1, 0, 0), (0, 0, -1), (0, -1, 0)),
            ((0, 0, 1), (0, 1, 0), (1, 0, 0)),
            ((0, 0, 1), (0, -1, 0), (-1, 0, 0)),
            ((0, 0, -1), (0, 1, 0), (-1, 0, 0)),
            ((0, 0, -1), (0, -1, 0), (1, 0, 0)),
        ]
    ],
    "m-3m": [
        [
            ((1, 0, 0), (0, 1, 0), (0, 0, 1)),
            ((-1, 0, 0), (0, -1, 0), (0, 0, 1)),
            ((-1, 0, 0), (0, 1, 0), (0, 0, -1)),
            ((1, 0, 0), (0, -1, 0), (0, 0, -1)),
            ((0, 0, 1), (1, 0, 0), (0, 1, 0)),
            ((0, 0, 1), (-1, 0, 0), (0, -1, 0)),
            ((0, 0, -1), (-1, 0, 0), (0, 1, 0)),
            ((0, 0, -1), (1, 0, 0), (0, -1, 0)),
            ((0, 1, 0), (0, 0, 1), (1, 0, 0)),
            ((0, -1, 0), (0, 0, 1), (-1, 0, 0)),
            ((0, 1, 0), (0, 0, -1), (-1, 0, 0)),
            ((0, -1, 0), (0, 0, -1), (1, 0, 0)),
            ((0, 1, 0), (1, 0, 0), (0, 0, -1)),
            ((0, -1, 0), (-1, 0, 0), (0, 0, -1)),
            ((0, 1, 0), (-1, 0, 0), (0, 0, 1)),
            ((0, -1, 0), (1, 0, 0), (0, 0, 1)),
            ((1, 0, 0), (0, 0, 1), (0, -1, 0)),
            ((-1, 0, 0), (0, 0, 1), (0, 1, 0)),
            ((-1, 0, 0), (0, 0, -1), (0, -1, 0)),
            ((1, 0, 0), (0, 0, -1), (0, 1, 0)),
            ((0, 0, 1), (0, 1, 0), (-1, 0, 0)),
            ((0, 0, 1), (0, -1, 0), (1, 0, 0)),
            ((0, 0, -1), (0, 1, 0), (1, 0, 0)),
            ((0, 0, -1), (0, -1, 0), (-1, 0, 0)),
            ((-1, 0, 0), (0, -1, 0), (0, 0, -1)),
            ((1, 0, 0), (0, 1, 0), (0, 0, -1)),
            ((1, 0, 0), (0, -1, 0), (0, 0, 1)),
            ((-1, 0, 0), (0, 1, 0), (0, 0, 1)),
            ((0, 0, -1), (-1, 0, 0), (0, -1, 0)),
            ((0, 0, -1), (1, 0, 0), (0, 1, 0)),
            ((0, 0, 1), (1, 0, 0), (0, -1, 0)),
            ((0, 0, 1), (-1, 0, 0), (0, 1, 0)),
            ((0, -1, 0), (0, 0, -1), (-1, 0, 0)),
            ((0, 1, 0), (0, 0, -1), (1, 0, 0)),
            ((0, -1, 0), (0, 0, 1), (1, 0, 0)),
            ((0, 1, 0), (0, 0, 1), (-1, 0, 0)),
            ((0, -1, 0), (-1, 0, 0), (0, 0, 1)),
            ((0, 1, 0), (1, 0, 0), (0, 0, 1)),
            ((0, -1, 0), (1, 0, 0), (0, 0, -1)),
            ((0, 1, 0), (-1, 0, 0), (0, 0, -1)),
            ((-1, 0, 0), (0, 0, -1), (0, 1, 0)),
            ((1, 0, 0), (0, 0, -1), (0, -1, 0)),
            ((1, 0, 0), (0, 0, 1), (0, 1, 0)),
            ((-1, 0, 0), (0, 0, 1), (0, -1, 0)),
            ((0, 0, -1), (0, -1, 0), (1, 0, 0)),
            ((0, 0, -1), (0, 1, 0), (-1, 0, 0)),
            ((0, 0, 1), (0, -1, 0), (-1, 0, 0)),
            ((0, 0, 1), (0, 1, 0), (1, 0, 0)),
        ]
    ],
}


def match_pointgroup(prim_rotations: NDArrayInt) -> tuple[NDArrayInt, list[int]]:
    """Match given crystallographic point group with standardized ones in primitive basis.

    Parameters
    ----------
    prim_rotations: (order, 3, 3)

    Returns
    -------
    std_rotations: (order, 3, 3)
    mapping: list
        prim_rotations[i] == std_rotations[mapping[i]]
    """
    pg_symbol, _, P = get_pointgroup(prim_rotations)
    Pinv = np.linalg.inv(P)

    order = len(prim_rotations)
    for std_rotations in pg_dataset[pg_symbol]:
        matched = [ndarray2d_to_integer_tuple(Pinv @ r @ P) for r in prim_rotations]

        success = True
        mapping = [-1 for _ in range(order)]
        for i, ri in enumerate(std_rotations):
            try:
                idx = matched.index(ri)  # type: ignore
            except ValueError:
                success = False
                break
            mapping[idx] = i
        if success:
            return np.array(std_rotations), mapping

    ValueError("Failed to match with tabulated point groups.")  # type: ignore
